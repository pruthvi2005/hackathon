<html>
  <head>
    <meta charset="utf-8" />
    <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect" />
    <link as="style"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Lexend%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
      onload="this.rel='stylesheet'"
      rel="stylesheet"
    />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <title>My Classes</title>
    <link rel="shortcut icon" href="../../Images/gamification (2).png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link href="data:image/x-icon;base64," rel="icon" type="image/x-icon" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script type="module" src="../../jsFiles/logout.js"></script>
    <style type="text/tailwindcss">
      :root {
        --primary-50: #f0fdf6;
        --primary-100: #dcfce9;
        --primary-200: #bbf7d4;
        --primary-300: #86efb5;
        --primary-400: #4ade8f;
        --primary-500: #20df6c;
        --primary-600: #16a34a;
        --primary-700: #15803d;
        --primary-800: #166534;
        --primary-900: #14532d;
        --primary-950: #052e16;
      }
    </style>
  
    <!-- Chatbot Integration -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="/js/instructor-header.js" defer></script>
    <style>
        /* Chatbot Styles */
        #ecolearn-chatbot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: #20df6c;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border: none;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .chatbot-toggle:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }
        
        .material-icons {
            font-size: 28px;
        }
    </style>
    </head>

 <body class="bg-gray-50 text-gray-900" style="font-family: Lexend, 'Noto Sans', sans-serif">
    <div class="relative flex size-full min-h-screen flex-col group/design-root overflow-x-hidden">
      <div class="layout-container flex h-full grow flex-col">
       <header
        class="flex items-center justify-between whitespace-nowrap border-b border-solid border-gray-200 px-10 py-3">
        </a>
        <div class="flex items-center gap-4 text-gray-900">
          <div class="text-green-500">
            <img class="w-10 h-10" src="../../Images/gamification%20(2).png" alt="EcoLearn Logo">
          </div>
          <div class="flex items-center gap-4 text-[#111811]">
            <div class="size-8">
              <img src="../../Images/gamification (2).png" alt="Gamification Icon"
                class="w-full h-full object-contain" />
            </div>
           <a href="EduDash.html"> <h2 class="text-[#111811] text-lg font-bold leading-tight tracking-[-0.015em]">EcoLearn</h2></a>
          </div>
        </div>
      <div class="flex items-center gap-8 text-gray-700 font-medium ">
        <a class="hover:text-gray-900 transition-colors" href="EduDash.html">Dashboard</a>
        <a class="hover:text-gray-900 transition-colors" href="EduMyClasses.html">My Classes</a>
        <a class="ext-gray-900 font-semibold" href="">Content Management</a>
        <a class="hover:text-gray-900 transition-colors" href="StuTracking.html">Analytics</a>
      </div>
      <div class="flex items-center space-x-4 relative">
        <a href="../Common/notifications.html" class="material-icons text-gray-600">notifications</a>
        <div class="relative">
          <!-- hidden checkbox acts as toggle -->
          <input type="checkbox" id="dropdownToggle" class="hidden peer">

          <!-- button (label for checkbox) -->
          <label for="dropdownToggle" class="flex items-center gap-2 cursor-pointer">
            <div class="h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center hover:bg-gray-300">
              <span class="material-icons text-gray-500">person</span>
            </div>
          </label>

          <!-- dropdown menu -->
          <div class="absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-xl z-10 p-2 hidden peer-checked:block">
            <a class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md" href="help&supportedu.html">
              <span class="material-symbols-outlined text-base">help</span>
              Help & Support
            </a>
            <a class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md" href="settingedu.html">
              <span class="material-symbols-outlined text-base">settings</span>
              Settings
            </a>
            <div class="my-1 border-t border-gray-100"></div>
            <a id="logoutButton" class="flex items-center gap-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md" href="">
                <span class="material-symbols-outlined text-base">logout</span>
                Sign Out
              </a>
                </div>
                </div>
            </div>
        </header>


        <!-- Main -->
        <main
          class="flex flex-1 justify-center py-10 px-4 sm:px-6 lg:px-8"
        >
          <div
            class="layout-content-container flex flex-col w-full max-w-6xl gap-8"
          >
            <!-- Title + Create New -->
            <div class="flex justify-between items-center px-4">
              <h1 class="text-2xl font-bold text-gray-900">Content Management</h1>
              <button id="newContentBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                <span class="material-icons">add</span>
                Create New Content
              </button>
            </div>

            <!-- New Content Modal -->
            <div id="contentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div class="bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                  <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">Create New Content</h3>
                    <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                      <span class="material-icons">close</span>
                    </button>
                  </div>
                  
                  <form id="contentForm" class="space-y-4">
                    <div>
                      <label for="contentType" class="block text-sm font-medium text-gray-700 mb-1">Content Type</label>
                      <select id="contentType" name="contentType" class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500">
                        <option value="lesson">Lesson</option>
                        <option value="quiz">Quiz</option>
                        <option value="assignment">Assignment</option>
                        <option value="video">Video</option>
                        <option value="game">Interactive Game</option>
                      </select>
                    </div>

                    <div>
                      <label for="contentTitle" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                      <input type="text" id="contentTitle" name="contentTitle" required
                        class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500">
                    </div>

                    <div>
                      <label for="contentDescription" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                      <textarea id="contentDescription" name="contentDescription" rows="3"
                        class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500"></textarea>
                    </div>

                    <!-- Quiz Fields (initially hidden) -->
                    <div id="quizFields" class="hidden space-y-4">
                      <div class="border-t border-gray-200 pt-4">
                        <h4 class="font-medium text-gray-900 mb-3">Quiz Questions</h4>
                        <div id="questionsContainer">
                          <!-- Questions will be added here dynamically -->
                        </div>
                        <button type="button" id="addQuestionBtn" class="mt-2 text-sm text-green-600 hover:text-green-800 flex items-center">
                          <span class="material-icons text-sm mr-1">add_circle</span>
                          Add Question
                        </button>
                      </div>
                    </div>

                    <div class="flex items-center">
                      <input id="isPublished" name="isPublished" type="checkbox"
                        class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                      <label for="isPublished" class="ml-2 block text-sm text-gray-700">
                        Publish immediately
                      </label>
                    </div>

                    <div class="flex justify-end space-x-3 pt-4">
                      <button type="button" id="cancelBtn" class="px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">
                        Cancel
                      </button>
                      <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                        Save Content
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            </div>

            <!-- Success Message -->
            <div id="successMessage" class="hidden fixed top-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg shadow-lg z-50">
              Content created successfully!
            </div>
                  
                  <form id="contentForm" class="space-y-4">
                    <div>
                      <label for="contentType" class="block text-sm font-medium text-gray-700 mb-1">Content Type</label>
                      <select id="contentType" name="contentType" required 
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        <option value="">Select content type</option>
                        <option value="lesson">Lesson</option>
                        <option value="quiz">Quiz</option>
                        <option value="assignment">Assignment</option>
                        <option value="video">Video</option>
                        <option value="game">Interactive Game</option>
                      </select>
                    </div>

                    <div>
                      <label for="contentTitle" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                      <input type="text" id="contentTitle" name="contentTitle" required
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
                        placeholder="Enter content title">
                    </div>

                    <div>
                      <label for="contentDescription" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                      <textarea id="contentDescription" name="contentDescription" rows="3"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
                        placeholder="Enter a brief description"></textarea>
                    </div>

                    <div id="quizFields" class="hidden space-y-4">
                      <div class="border-t border-gray-200 pt-4">
                        <h4 class="font-medium text-gray-900 mb-3">Quiz Questions</h4>
                        <div id="questionsContainer">
                          <!-- Questions will be added here dynamically -->
                        </div>
                        <button type="button" id="addQuestionBtn" class="mt-2 text-sm text-green-600 hover:text-green-800 flex items-center">
                          <span class="material-icons text-sm mr-1">add_circle</span>
                          Add Question
                        </button>
                      </div>
                    </div>

                    <div class="flex items-center">
                      <input id="isPublished" name="isPublished" type="checkbox" 
                        class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                      <label for="isPublished" class="ml-2 block text-sm text-gray-700">
                        Publish immediately
                      </label>
                    </div>

                    <div class="flex justify-end gap-3 pt-4 border-t border-gray-200">
                      <button type="button" id="cancelBtn" class="px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg">
                        Cancel
                      </button>
                      <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg">
                        Save Content
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            </div>

            <!-- Success Message -->
            <div id="successMessage" class="hidden fixed top-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg shadow-lg z-50">
              Content created successfully!
            </div>
            <div class="flex flex-wrap items-center justify-between gap-4">
              <div class="flex flex-col gap-1">
                <h2
                  class="text-[var(--text-primary)] text-4xl font-bold leading-tight tracking-tight"
                >
                  Content Management
                </h2>
                <p
                  class="text-[var(--text-secondary)] text-base font-normal leading-normal"
                >
                  Manage your quizzes, games, and other educational materials.
                </p>
              </div>
              <button
                class="btn-primary flex items-center justify-center gap-2 rounded-lg h-12 px-6 text-base font-bold leading-normal tracking-wide shadow-md hover:shadow-lg transition-shadow"
              >
                <span class="material-symbols-outlined"> add_circle </span>
                <span class="truncate">Create New</span>
              </button>
            </div>

            <!-- Search + Filter -->
            <div class="flex flex-col gap-6">
              <div class="flex items-center justify-between gap-4">
                <div class="relative flex-1">
                  <span
                    class="material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-[var(--text-secondary)]"
                  >
                    search
                  </span>
                  <input
                    class="form-input w-full rounded-lg border-gray-300 bg-white py-3 pl-12 pr-4 text-[var(--text-primary)] focus:border-[var(--primary-color)] focus:ring-[var(--primary-color)] placeholder:text-[var(--text-secondary)]"
                    placeholder="Search for content..."
                    type="search"
                  />
                </div>
                <div class="flex items-center gap-2">
                  <button
                    class="flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-50"
                  >
                    <span class="material-symbols-outlined text-base">
                      filter_list
                    </span>
                    <span>Filter</span>
                  </button>
                  <button
                    class="flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-50"
                  >
                    <span class="material-symbols-outlined text-base">
                      swap_vert
                    </span>
                    <span>Sort</span>
                  </button>
                </div>
              </div>

              <!-- Tabs -->
              <div class="border-b border-gray-200">
                <nav aria-label="Tabs" class="-mb-px flex space-x-8 px-4">
                  <a
                    aria-current="page"
                    class="border-[var(--primary-color)] text-[var(--primary-color)] whitespace-nowrap border-b-2 py-4 px-1 text-base font-semibold"
                    href="#"
                  >
                    My Content
                  </a>
                  <a
                    class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 whitespace-nowrap border-b-2 py-4 px-1 text-base font-medium"
                    href="#"
                  >
                    Shared with Me
                  </a>
                  <a
                    class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 whitespace-nowrap border-b-2 py-4 px-1 text-base font-medium"
                    href="#"
                  >
                    Public Library
                  </a>
                </nav>
              </div>
            </div>

            <!-- Content List -->
            <section class="flex flex-col gap-4 mt-8">
              <h3 class="text-xl font-bold text-gray-900 px-4">My Content</h3>
              <div id="contentList" class="bg-white shadow overflow-hidden sm:rounded-lg">
                <!-- Content will be loaded here -->
                <div class="px-6 py-4 text-center text-gray-500">
                  You haven't created any content yet. Click "Create New Content" to get started.
                </div>
              </div>
            </section>

            <!-- My Quizzes -->
            <section class="flex flex-col gap-4">
              <h3
                class="text-[var(--text-primary)] text-2xl font-bold leading-tight tracking-tight px-4"
              >
                My Quizzes
              </h3>
              <div
                class="overflow-x-auto rounded-lg border border-gray-200 bg-white shadow-sm"
              >
                <table class="w-full min-w-full text-sm">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-6 py-4 text-left font-semibold text-gray-900"
                        scope="col"
                      >
                        Title
                      </th>
                      <th
                        class="px-6 py-4 text-left font-semibold text-gray-900"
                        scope="col"
                      >
                        Subject
                      </th>
                      <th
                        class="px-6 py-4 text-left font-semibold text-gray-900"
                        scope="col"
                      >
                        Grade Level
                      </th>
                      <th
                        class="px-6 py-4 text-left font-semibold text-gray-900"
                        scope="col"
                      >
                        Status
                      </th>
                      <th
                        class="relative py-4 pl-3 pr-6"
                        scope="col"
                      >
                        <span class="sr-only">Actions</span>
                      </th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-gray-200 bg-white">
                    <tr>
                      <td class="whitespace-nowrap px-6 py-5 font-medium text-gray-900">
                        Environmental Science Quiz 1
                      </td>
                      <td class="whitespace-nowrap px-6 py-5 text-gray-500">
                        Environmental Science
                      </td>
                      <td class="whitespace-nowrap px-6 py-5 text-gray-500">
                        High School
                      </td>
                      <td class="whitespace-nowrap px-6 py-5">
                        <span
                          class="inline-flex items-center rounded-full px-3 py-1 text-xs font-medium status-published"
                          >Published</span
                        >
                      </td>
                      <td
                        class="whitespace-nowrap py-5 pl-3 pr-6 text-right text-sm font-medium"
                      >
                        <a
                          class="text-[var(--primary-color)] hover:text-green-700"
                          href="#"
                          >Edit</a
                        >
                        <span class="mx-2 text-gray-300">|</span>
                        <a
                          class="text-green-500 hover:text-blue-800"
                          href="#"
                          >Assign</a
                        >
                      </td>
                    </tr>
                    <tr>
                      <td class="whitespace-nowrap px-6 py-5 font-medium text-gray-900">
                        Sustainability Basics
                      </td>
                      <td class="whitespace-nowrap px-6 py-5 text-gray-500">
                        Sustainability
                      </td>
                      <td class="whitespace-nowrap px-6 py-5 text-gray-500">
                        Middle School
                      </td>
                      <td class="whitespace-nowrap px-6 py-5">
                        <span
                          class="inline-flex items-center rounded-full px-3 py-1 text-xs font-medium status-draft"
                          >Draft</span
                        >
                      </td>
                      <td
                        class="whitespace-nowrap py-5 pl-3 pr-6 text-right text-sm font-medium"
                      >
                        <a
                          class="text-[var(--primary-color)] hover:text-green-700"
                          href="#"
                          >Edit</a
                        >
                        <span class="mx-2 text-gray-300">|</span>
                        <a
                          class="text-green-500 hover:text-blue-800"
                          href="#"
                          >Assign</a
                        >
                      </td>
                    </tr>
                    <tr>
                      <td class="whitespace-nowrap px-6 py-5 font-medium text-gray-900">
                        Climate Change Awareness
                      </td>
                      <td class="whitespace-nowrap px-6 py-5 text-gray-500">
                        Climate Change
                      </td>
                      <td class="whitespace-nowrap px-6 py-5 text-gray-500">
                        High School
                      </td>
                      <td class="whitespace-nowrap px-6 py-5">
                        <span
                          class="inline-flex items-center rounded-full px-3 py-1 text-xs font-medium status-published"
                          >Published</span
                        >
                      </td>
                      <td
                        class="whitespace-nowrap py-5 pl-3 pr-6 text-right text-sm font-medium"
                      >
                        <a
                          class="text-[var(--primary-color)] hover:text-green-700"
                          href="#"
                          >Edit</a
                        >
                        <span class="mx-2 text-gray-300">|</span>
                        <a
                          class="text-green-500 hover:text-blue-800"
                          href="#"
                          >Assign</a
                        >
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </section>

            <!-- My Games -->
            <section class="flex flex-col gap-4">
              <h3
                class="text-[var(--text-primary)] text-2xl font-bold leading-tight tracking-tight px-4"
              >
                My Games
              </h3>
              <div
                class="overflow-x-auto rounded-lg border border-gray-200 bg-white shadow-sm"
              >
                <table class="w-full min-w-full text-sm">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-6 py-4 text-left font-semibold text-gray-900"
                        scope="col"
                      >
                        Title
                      </th>
                      <th
                        class="px-6 py-4 text-left font-semibold text-gray-900"
                        scope="col"
                      >
                        Subject
                      </th>
                      <th
                        class="px-6 py-4 text-left font-semibold text-gray-900"
                        scope="col"
                      >
                        Grade Level
                      </th>
                      <th
                        class="px-6 py-4 text-left font-semibold text-gray-900"
                        scope="col"
                      >
                        Status
                      </th>
                      <th
                        class="relative py-4 pl-3 pr-6"
                        scope="col"
                      >
                        <span class="sr-only">Actions</span>
                      </th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-gray-200 bg-white">
                    <tr>
                      <td class="whitespace-nowrap px-6 py-5 font-medium text-gray-900">
                        Eco-Adventure Game
                      </td>
                      <td class="whitespace-nowrap px-6 py-5 text-gray-500">
                        Environmental Science
                      </td>
                      <td class="whitespace-nowrap px-6 py-5 text-gray-500">
                        Elementary School
                      </td>
                      <td class="whitespace-nowrap px-6 py-5">
                        <span
                          class="inline-flex items-center rounded-full px-3 py-1 text-xs font-medium status-published"
                          >Published</span
                        >
                      </td>
                      <td
                        class="whitespace-nowrap py-5 pl-3 pr-6 text-right text-sm font-medium"
                      >
                        <a
                          class="text-[var(--primary-color)] hover:text-green-700"
                          href="#"
                          >Edit</a
                        >
                        <span class="mx-2 text-gray-300">|</span>
                        <a
                          class="text-green-500 hover:text-blue-800"
                          href="#"
                          >Assign</a
                        >
                      </td>
                    </tr>
                    <tr>
                      <td class="whitespace-nowrap px-6 py-5 font-medium text-gray-900">
                        Recycling Challenge
                      </td>
                      <td class="whitespace-nowrap px-6 py-5 text-gray-500">
                        Sustainability
                      </td>
                      <td class="whitespace-nowrap px-6 py-5 text-gray-500">
                        Middle School
                      </td>
                      <td class="whitespace-nowrap px-6 py-5">
                        <span
                          class="inline-flex items-center rounded-full px-3 py-1 text-xs font-medium status-draft"
                          >Draft</span
                        >
                      </td>
                      <td
                        class="whitespace-nowrap py-5 pl-3 pr-6 text-right text-sm font-medium"
                      >
                        <a
                          class="text-[var(--primary-color)] hover:text-green-700"
                          href="#"
                          >Edit</a
                        >
                        <span class="mx-2 text-gray-300">|</span>
                        <a
                          class="text-green-500 hover:text-blue-800"
                          href="#"
                          >Assign</a
                        >
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </section>
          </div>
        </main>
      </div>
    </div>
          <!-- Chatbot Container -->
        <div id="ecolearn-chatbot-container"></div>
    </body>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, getDoc, doc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

    // Initialize Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyB8ouWfnnQ3YkpvRl65BZzjdwITHLLhhtc",
      authDomain: "ecolearn-7152f.firebaseapp.com",
      projectId: "ecolearn-7152f",
      storageBucket: "ecolearn-7152f.firebasestorage.app",
      messagingSenderId: "656526494781",
      appId: "1:656526494781:web:e49084105be0db03102e54"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // DOM Elements
    const modal = document.getElementById('contentModal');
    const newContentBtn = document.getElementById('newContentBtn');
    const closeModal = document.getElementById('closeModal');
    const cancelBtn = document.getElementById('cancelBtn');
    const contentForm = document.getElementById('contentForm');
    const contentTypeSelect = document.getElementById('contentType');
    const quizFields = document.getElementById('quizFields');
    const questionsContainer = document.getElementById('questionsContainer');
    const addQuestionBtn = document.getElementById('addQuestionBtn');
    const successMessage = document.getElementById('successMessage');
    let questionCount = 0;

    // Initialize event listeners
    function initEventListeners() {
      if (newContentBtn) newContentBtn.addEventListener('click', toggleModal);
      if (closeModal) closeModal.addEventListener('click', toggleModal);
      if (cancelBtn) cancelBtn.addEventListener('click', toggleModal);
      if (contentForm) contentForm.addEventListener('submit', handleSubmit);
      if (contentTypeSelect) contentTypeSelect.addEventListener('change', toggleQuizFields);
      if (addQuestionBtn) addQuestionBtn.addEventListener('click', addQuestion);
    }

    // Format Date
    function formatDate(date) {
      return new Date(date).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
    }

    // Toggle modal
    function toggleModal() {
      if (modal) {
        modal.classList.toggle('hidden');
        document.body.style.overflow = modal.classList.contains('hidden') ? 'auto' : 'hidden';
      }
    }

    // Show/hide quiz fields based on content type
    function toggleQuizFields() {
      if (contentTypeSelect && quizFields) {
        if (contentTypeSelect.value === 'quiz') {
          quizFields.classList.remove('hidden');
        } else {
          quizFields.classList.add('hidden');
        }
      }
    }

    // Add question fields
    function addQuestion() {
      if (!questionsContainer) return;
      
      questionCount++;
      const questionId = `q${Date.now()}`;
      const questionDiv = document.createElement('div');
      questionDiv.className = 'question-item mb-6 p-4 border border-gray-200 rounded-lg';
      questionDiv.innerHTML = `
        <div class="flex justify-between items-center mb-2">
          <h5 class="font-medium">Question ${questionCount}</h5>
          <button type="button" class="text-red-500 hover:text-red-700 remove-question">
            <span class="material-icons text-sm">delete</span>
          </button>
        </div>
        <div class="mb-3">
          <input type="text" name="question-${questionId}" required
            class="w-full px-3 py-2 border border-gray-300 rounded-lg"
            placeholder="Enter question">
        </div>
        <div class="space-y-2 ml-4">
          ${[1, 2, 3, 4].map((_, i) => `
            <div class="flex items-center">
              <input type="radio" name="correct-${questionId}" value="${i}" ${i === 0 ? 'checked' : ''}
                class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300">
              <input type="text" name="option-${questionId}-${i}" required
                class="ml-2 px-3 py-1 border border-gray-300 rounded-lg w-full"
                placeholder="Option ${i + 1}">
            </div>
          `).join('')}
        </div>
      `;
      
      // Add delete functionality
      const deleteBtn = questionDiv.querySelector('.remove-question');
      if (deleteBtn) {
        deleteBtn.addEventListener('click', () => {
          questionDiv.remove();
          questionCount--;
          // Renumber remaining questions
          document.querySelectorAll('.question-item').forEach((item, index) => {
            const title = item.querySelector('h5');
            if (title) title.textContent = `Question ${index + 1}`;
          });
        });
      }
      
      questionsContainer.appendChild(questionDiv);
    }

    // Handle form submission
    async function handleSubmit(e) {
      e.preventDefault();
      
      if (!contentForm || !auth.currentUser) {
        window.location.href = '../Welcome/signin.html';
        return;
      }

      const user = auth.currentUser;
      const formData = new FormData(contentForm);
      const contentData = {
        type: formData.get('contentType'),
        title: formData.get('contentTitle'),
        description: formData.get('contentDescription'),
        isPublished: formData.get('isPublished') === 'on',
        createdAt: serverTimestamp(),
        createdBy: user.uid,
        school: ''
      };

      try {
        // Get user's school
        const userDoc = await getDoc(doc(db, 'users', user.uid));
        if (userDoc.exists()) {
          contentData.school = userDoc.data().schoolName || '';
        }

        // Handle quiz questions if content type is quiz
        if (contentData.type === 'quiz' && questionsContainer) {
          const questions = [];
          const questionItems = questionsContainer.querySelectorAll('.question-item');
          
          questionItems.forEach((item) => {
            const questionInput = item.querySelector('input[type="text"]');
            if (!questionInput) return;
            
            const questionText = questionInput.value;
            const options = [];
            let correctAnswer = 0;
            
            // Get all option inputs
            const optionInputs = item.querySelectorAll('input[type="text"]:not([name^="question-"])');
            optionInputs.forEach((input, index) => {
              options.push(input.value);
              // Check if this option is the correct answer
              const radioInput = input.previousElementSibling;
              if (radioInput && radioInput.checked) {
                correctAnswer = index;
              }
            });
            
            if (questionText) {
              questions.push({
                text: questionText,
                options: options,
                correctAnswer: correctAnswer
              });
            }
          });
          
          if (questions.length > 0) {
            contentData.questions = questions;
          }
        }

        // Save to Firestore
        const docRef = await addDoc(collection(db, 'content'), contentData);
        console.log('Document written with ID: ', docRef.id);
        
        // Show success message
        if (successMessage) {
          successMessage.classList.remove('hidden');
          setTimeout(() => {
            successMessage.classList.add('hidden');
          }, 3000);
        }
        
        // Reset form and close modal
        if (contentForm) contentForm.reset();
        if (questionsContainer) questionsContainer.innerHTML = '';
        questionCount = 0;
        toggleModal();
        
      } catch (error) {
        console.error('Error adding document: ', error);
        alert('Error creating content. Please try again.');
      }
    }

    // Initialize the page
    function init() {
      initEventListeners();
      
      // Close modal when clicking outside
      window.addEventListener('click', (e) => {
        if (e.target === modal) {
          toggleModal();
        }
      });
      
      // Initialize any other components
      if (contentTypeSelect && contentTypeSelect.value === 'quiz') {
        quizFields.classList.remove('hidden');
      }
    }
    
    // Start the application
    document.addEventListener('DOMContentLoaded', init);
      if (e.target.closest('.remove-question')) {
        e.target.closest('.question-item').remove();
        // Renumber remaining questions
        document.querySelectorAll('.question-item h5').forEach((el, i) => {
          el.textContent = `Question ${i + 1}`;
        });
      }
  </script>
  <style>
    /* Add some additional styles for better modal scrolling */
    @media (max-height: 640px) {
      #contentModal .bg-white {
        max-height: 90vh;
        overflow-y: auto;
      }
    }
  </style>
</html>
